<apex:page showHeader="false" sidebar="false">
<META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=UTF-8"></META>
<meta content="width=device-width, initial-scale=1" name="viewport" />

<script src="https://www.google.com/recaptcha/api.js"></script>
<script>
 function timestamp() { 
    var response = document.getElementById("g-recaptcha-response"); 
    if (response == null || response.value.trim() == "") {
        var elems = JSON.parse(document.getElementsByName("captcha_settings")[0].value);
        elems["ts"] = JSON.stringify(new Date().getTime());
        document.getElementsByName("captcha_settings")[0].value = JSON.stringify(elems); 
    } } setInterval(timestamp, 500); 
</script>

<apex:stylesheet value="{!$Resource.leadSiteCss}" />
<style>
.background-image {
  position: absolute;
  left: 0;
  right: 0;
  z-index: 1;
  display: block;
  background-image: url("{!$Resource.webToLeadBackground}");
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  width: 100%;
  height: 100%;
  min-height: 100dvh
  -webkit-filter: blur(5px);
  -moz-filter: blur(5px);
  -o-filter: blur(5px);
  -ms-filter: blur(5px);
  filter: blur(5px);
}
</style>

<div class="background-image"></div>
<div class="logo-container">
    <apex:image url="{!$Resource.sparkSalesLogo}" alt="Logo" />
</div>

<span id="loader" class="loader"></span>

<div class="content">
    <div class="wrapper"> 
        <form id="form" action="https://webto.salesforce.com/servlet/servlet.WebToLead?encoding=UTF-8&orgId=00DgL0000061haY" method="POST" class="card">
            <h2>Contact Us</h2>
            
            <p class="company-message">
                Looking to Partner with a Trusted Electronics Supplier?
                We at Spark Sales specialize in high-quality electronics solutions for businesses of all sizes.
                Fill out the form below and our team will get back to you shortly to discuss your needs.
            </p>
            <input type="hidden" name='captcha_settings' value='{"keyname":"WebToLeadCaptcha","fallback":"true","orgId":"00DgL0000061haY","ts":""}'/>
            <input type="hidden" name="oid" value="00DgL0000061haY"/>
            <input type="hidden" name="retURL" value="https://sparksales-dev-ed.develop.my.salesforce-sites.com/ThankYou"/>
            <input  id="lead_source" name="lead_source" value="Web" hidden="true"/>
            
            <label for="first_name" value="First Name">First Name</label>
            <input  id="first_name" maxlength="40" name="first_name" size="20" type="text" autocomplete="on"/><br/>
            <div id="first_name_error" class="error-message"></div>
            
            <label for="last_name" value="Last Name" class="required-label">Last Name</label>
            <input id="last_name" maxlength="80" name="last_name" size="20" type="text" required="true" autocomplete="on"/><br/>
            <div id="last_name_error" class="error-message"></div>
            
            <label for="email" value="Email" class="required-label">Email</label>
            <input id="email" maxlength="80" name="email" size="20" type="email" required="true" autocomplete="on"/><br/>
            <div id="email_error" class="error-message"></div>
            
            <label for="phone" value="Phone" class="required-label">Phone</label>
            <input id="phone" maxlength="40" name="phone" size="20" type="tel" required="true" autocomplete="on"/><br/>
            <div id="phone_error" class="error-message"></div>
            
            <label for="company" value="Company" class="required-label">Company</label>
            <input id="company" maxlength="40" name="company" size="20" type="text" required="true" autocomplete="on"/><br/>
            <div id="company_error" class="error-message"></div>
            
            <div class="agreement-container">
                <label>
                    <input id="contact_agreement" name="contact_agreement" type="checkbox" required="true"/>
                    I consent to the storage and processing of my personal data by this organization. 
                    I understand that I may be contacted regarding services or offers and that my data will not be shared with third parties without my consent.
                </label>
            </div>
            <div id="contact_agreement_error" class="error-message"></div>

            <div id="recaptcha" class="g-recaptcha captcha" data-sitekey="6LddeocrAAAAALQLGFwpSAGJaM9LrzpjuOJhgA7O"></div>
            <div id="recaptcha_error" class="error-message"></div>

            <input type="submit" name="submit"/>
            <input type="reset" value="Reset"/>
        </form>
    </div>
</div>

<footer class="site-footer">
  <div class="footer-company">
    &copy; 2025 Spark Sales. All rights reserved.
  </div>
  <div class="footer-bottom">
    <a href="mailto:info@sparksales.com">info@sparksales.com</a> |
    <a href="tel:+48 363 345 345">+48 363 345 345</a> |
    al.Kra≈õnickie 123 Lublin
  </div>
</footer>

<script>
    let submitLock = false;
    function showError(fieldId, message) {
        const errorElem = document.getElementById(fieldId + "_error");
        const inputElem = document.getElementById(fieldId);
        errorElem.textContent = message;
        errorElem.style.display = message ? "block" : "none";
    }
    
    function validateForm() {
        let isValid = true;
        
        const namePattern = /^[A-Z][a-z]*(-[A-Z][a-z]*)?/;
        const phonePattern = /^\+?[1-9][0-9\s\-]+$/;
        const emailPattern = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        
        document.querySelectorAll('.error-message').forEach(function(el) {
            el.style.display = 'none';
        });
        
        let firstName = document.getElementById('first_name').value;
        
        if (firstName) {
            if (!namePattern.test(firstName)) {
                showError("first_name", "First name contains invalid characters or begins with a lowercase letter.");
                isValid = false;
            } else if (firstName.length > 40 && firstName.length < 3) {
                showError("first_name", "First name must be between 3 and 40 characters.");
                isValid = false;
            }
        }
        
        let lastName = document.getElementById('last_name').value;
        if (!namePattern.test(lastName)) {
            showError("last_name", "Last name contains invalid characters or begins with a lowercase letter.");
            isValid = false;
        } else if (lastName.length < 2 || lastName.length > 80) {
            showError("last_name", "Last name must be between 2 and 80 characters.");
            isValid = false;
        }
        
        let phone = document.getElementById('phone').value;
        if (!phonePattern.test(phone)) {
            showError("phone", "Phone contains invalid characters.");
            isValid = false;
        } else if (phone.length < 7 || phone.length > 20) {
            showError("phone", "Phone number must be between 7 and 20 characters.");
            isValid = false;
        }
        
        let email = document.getElementById('email').value;
        if (!emailPattern.test(email)) {
            showError("email", "Enter a valid email address.");
            isValid = false;
        } else if (email.length < 7 || email.length > 80) {
            showError("email", "Email must be between 7 and 80 characters.");
        }
        
        let company = document.getElementById('company').value;
        if(!company) {
            showError("company", "Company name is required");
            isValid = false;
        } else if (company.length > 255) {
            showError("company", "Company name must have a maximum of 255 characters.");
            isValid = false;
        }

        let checkbox = document.getElementById("contact_agreement").value
        if(!checkbox){
            showError("contact_agreement", "You must agree to the terms before continuing.");
            isValid = false;
        }

        let response = document.getElementById("g-recaptcha-response");
        if (response == null || response.value.trim() == "") {
            showError("recaptcha", "Please verify that you are not a robot.");
            isValid = false;
        }
        

        return isValid;
    }
    
    document.getElementById('form').addEventListener('submit', function(event) {
        if (submitLock || !validateForm()) {
            event.preventDefault();
        }else{
            submitLock = true;
            // remove after test
            //event.preventDefault();
            document.getElementById('loader').style.visibility = 'visible';
        }
    });
    
    document.getElementById('form').addEventListener('reset', function(event) {
        if(submitLock){
            event.preventDefault();
        }else{
            document.querySelectorAll('.error-message').forEach(function(el) {
                el.style.display = 'none';
            });
        }
    });
    
</script>
</apex:page>